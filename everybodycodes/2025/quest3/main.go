package main

import (
	"aoc/internal/container"
	"aoc/internal/conv"
	"aoc/internal/slicesx"
	"fmt"
	"maps"
	"slices"
)

func main() {
	partI()
	partII()
	partIII()
}

func partI() {
	input := "31,83,84,5,33,26,51,5,72,31,69,74,53,21,65,76,58,29,74,20,6,63,87,55,57,71,38,55,75,66,70,18,39,19,74,52,44,61,41,54,72,12,35,28,65,25,35,2,46,9,66,71,34,3,41,7,9,16,58,50,48,69,20,3,23,28,87,44,11,29,39,23,62,71,16,15,74,52,51,14,46,15,89,38,27,41,37,86,49,50,27,72,66,33,54,43,58,58,24,87"
	crates := conv.ToIntSliceComma(input)

	uniqueCrates := slicesx.Unique(crates)

	sum := slicesx.Sum(uniqueCrates)
	fmt.Println(sum)
}

func partII() {
	input := "122,23,7,121,103,128,165,63,105,63,105,22,101,2,20,120,107,103,176,158,42,146,159,131,166,74,75,99,36,179,177,114,3,50,21,133,58,58,53,107,93,147,15,58,145,29,154,45,81,187,149,174,165,2,3,5,31,75,126,74,187,189,150,59,111,39,171,4,139,61,34,45,44,110,110,65,88,163,150,176,81,71,116,122,4,121,22,107,27,146,85,147,128,108,123,120,129,69,154,51,136,131,37,48,156,163,83,30,102,139,112,67,111,97,93,142,148,162,104,166,58,36,30,189,40,140,12,147,168,160,7,97,48,110,69,154,16,173,140,71,161,117,136,168,34,31,79,169,164,151,178,136,61,51,178,183,63,97,80,5,11,57,29,144,119,108,15,11,63,140,171,90,90,3,114,86,128,31,69,27,100,159,165,98,49,169,36,21,117,182,43,121,114,132,68,183,122,63,130,1,79,113,70,165,97,96,120,127,127,176,187,141,135,46,117,103,21,187,89,97,181,58,160,131,10,28,177,180,188,71,53,183,37,82,31,95,79,119,126,66,71,80,62,148,62,11,79,101,64,12,60,132,88,181,21,31,90,27,82,18,101,23,122,64,111,149,104,128,154,185,18,77,185,137,1,74,165,48,187,141,103,124,109,166,102,58,43,6,2,144,143,175,123,34,150,31,176,114,166,32"
	crates := conv.ToIntSliceComma(input)

	top20Crates := slicesx.Unique(crates)
	slices.Sort(top20Crates)
	top20Crates = top20Crates[:20]

	sum := slicesx.Sum(top20Crates)
	fmt.Println(sum)

}

func partIII() {
	input := "59,64,71,36,28,31,73,50,50,34,20,20,20,20"
	crates := conv.ToInt64SliceComma(input)

	bag := container.NewBag[int64]()
	for _, crate := range crates {
		bag.Add(crate)
	}

	fmt.Println(slices.Max(slices.Collect(maps.Values(bag.Values()))))
}
